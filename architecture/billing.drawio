<mxfile host="app.diagrams.net" modified="2022-07-04T20:20:06.629Z" agent="5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36" etag="bIrl72OpVh3ZobfoiF1e" version="17.4.0" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="750" dy="2367" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1920" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="OZho7mV1Ze3KkDtRldih-18" value="&lt;span style=&quot;color: rgb(26, 27, 34); font-family: &amp;quot;YS Text&amp;quot;, Arial, Helvetica, sans-serif; font-size: 18px; text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;Выполните проект «Биллинг». Нужно сделать два метода работы с картами: оплатить подписку и вернуть за неё деньги. При этом система должна быть устойчивой к перебоям: не должно происходить двойных списаний, и чтобы у пользователя всегда была гарантия, что операция выполнилась. Помимо реализации системы, интегрируйте эту систему с админкой Django, чтобы вы могли контролировать оплату подписок клиентами.&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="20" y="-90" width="530" height="220" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-19" target="OZho7mV1Ze3KkDtRldih-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-19" value="Контроль оплаты подписок&lt;br&gt;«Admin Panel»&lt;br&gt;&lt;b&gt;[Django]&lt;/b&gt;" style="html=1;dropTarget=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="160" y="180" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-20" value="" style="shape=module;jettyWidth=8;jettyHeight=4;" parent="OZho7mV1Ze3KkDtRldih-19" vertex="1">
          <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
            <mxPoint x="-27" y="7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-97" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0;entryDx=0;entryDy=37.5;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-21" target="OZho7mV1Ze3KkDtRldih-38" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="490" y="348" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-101" value="Забирает намерение о подписке со статусом pending" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OZho7mV1Ze3KkDtRldih-97" vertex="1" connectable="0">
          <mxGeometry x="-0.6724" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-99" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-21" target="OZho7mV1Ze3KkDtRldih-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-100" value="Отправляет таску на создание подписки" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OZho7mV1Ze3KkDtRldih-99" vertex="1" connectable="0">
          <mxGeometry x="-0.2648" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-21" value="Контроль оплаты подписок&lt;br&gt;«Scheduler»&lt;br&gt;&lt;b&gt;[Python app]&lt;/b&gt;" style="html=1;dropTarget=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="400" y="180" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-22" value="" style="shape=module;jettyWidth=8;jettyHeight=4;" parent="OZho7mV1Ze3KkDtRldih-21" vertex="1">
          <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
            <mxPoint x="-27" y="7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-64" value="Создание записи о намерении подписки" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.38;entryY=1.025;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.426;exitY=0.013;exitDx=0;exitDy=0;exitPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-23" target="OZho7mV1Ze3KkDtRldih-38" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="210" y="470" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-65" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.076;entryY=0.506;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-23" target="OZho7mV1Ze3KkDtRldih-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-66" value="Формирование&amp;nbsp;&lt;br&gt;checkout url" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OZho7mV1Ze3KkDtRldih-65" vertex="1" connectable="0">
          <mxGeometry x="0.1634" y="-2" relative="1" as="geometry">
            <mxPoint x="-4" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-23" target="OZho7mV1Ze3KkDtRldih-34" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="400" y="560" />
              <mxPoint x="400" y="660" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-23" value="Создание/отмена подписки&lt;br&gt;«API&amp;nbsp;&lt;span style=&quot;text-align: left;&quot;&gt;subscription&lt;/span&gt;»&lt;br&gt;&lt;b&gt;[FastApi]&lt;/b&gt;" style="html=1;dropTarget=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="160" y="470" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-24" value="" style="shape=module;jettyWidth=8;jettyHeight=4;" parent="OZho7mV1Ze3KkDtRldih-23" vertex="1">
          <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
            <mxPoint x="-27" y="7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-40" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-26" target="OZho7mV1Ze3KkDtRldih-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-26" value="Admin" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="70" y="200" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-27" target="OZho7mV1Ze3KkDtRldih-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-27" value="User" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="60" y="490" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-30" value="Subscription&lt;br&gt;status&lt;br&gt;queue" style="shape=datastore;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="670" y="630" width="70" height="70" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-80" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-34" target="OZho7mV1Ze3KkDtRldih-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-34" value="&lt;span style=&quot;&quot;&gt;RabbitMQ&lt;/span&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="490" y="635" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-35" value="Рассылка уведомлений&lt;br&gt;«Notification Service»&lt;br&gt;&lt;b&gt;[FastApi]&lt;/b&gt;" style="html=1;dropTarget=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="870" y="770" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-36" value="" style="shape=module;jettyWidth=8;jettyHeight=4;" parent="OZho7mV1Ze3KkDtRldih-35" vertex="1">
          <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
            <mxPoint x="-27" y="7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-38" value="Подписки пользователей&lt;br&gt;[postgres]" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="205" y="310" width="90" height="120" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-44" value="Stripe API&lt;br&gt;[Gateway api]" style="ellipse;shape=cloud;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="490" y="480" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-47" value="Админ &quot;user story&quot;" style="swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="710" y="10" width="150" height="90" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-48" value="может просматривать&#xa;подписки пользователей" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;" parent="OZho7mV1Ze3KkDtRldih-47" vertex="1">
          <mxGeometry y="30" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-49" value="может смотреть статус, &#xa;цену, длительность" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;" parent="OZho7mV1Ze3KkDtRldih-47" vertex="1">
          <mxGeometry y="60" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-62" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-58" target="OZho7mV1Ze3KkDtRldih-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-58" value="Таблицы" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;strokeColor=default;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="30" y="325" width="140" height="90" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-59" value="intention (намерение)&#xa; подписки" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;fontStyle=0" parent="OZho7mV1Ze3KkDtRldih-58" vertex="1">
          <mxGeometry y="30" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-60" value="subscription (текущие&#xa; подписки)" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;" parent="OZho7mV1Ze3KkDtRldih-58" vertex="1">
          <mxGeometry y="60" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-90" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-88" target="OZho7mV1Ze3KkDtRldih-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-91" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-88" target="OZho7mV1Ze3KkDtRldih-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-92" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.994;entryY=0.835;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-88" target="OZho7mV1Ze3KkDtRldih-38" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="760" y="410" />
              <mxPoint x="294" y="410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-93" value="Меняет запись об успешности оформления подписки" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OZho7mV1Ze3KkDtRldih-92" vertex="1" connectable="0">
          <mxGeometry x="0.422" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-95" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.993;entryY=0.669;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" target="OZho7mV1Ze3KkDtRldih-38" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="780.4844827586207" y="770" as="sourcePoint" />
            <mxPoint x="295.00000000000017" y="333.2800000000002" as="targetPoint" />
            <Array as="points">
              <mxPoint x="781" y="390" />
              <mxPoint x="294" y="390" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-96" value="Создает запись об активной подписке" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OZho7mV1Ze3KkDtRldih-95" vertex="1" connectable="0">
          <mxGeometry x="0.6441" y="-1" relative="1" as="geometry">
            <mxPoint x="91" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="913VA-e47dgmbzV00SAF-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="OZho7mV1Ze3KkDtRldih-88" target="913VA-e47dgmbzV00SAF-0" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="910" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-88" value="Worker&lt;br&gt;«Забирает таски»&lt;br&gt;&lt;b&gt;[Python app]&lt;/b&gt;" style="html=1;dropTarget=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="615" y="770" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-89" value="" style="shape=module;jettyWidth=8;jettyHeight=4;" parent="OZho7mV1Ze3KkDtRldih-88" vertex="1">
          <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
            <mxPoint x="-27" y="7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="913VA-e47dgmbzV00SAF-0" value="Сервис Auth&lt;br&gt;&lt;b&gt;[Flask app]&lt;/b&gt;" style="html=1;dropTarget=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="890" y="580" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="913VA-e47dgmbzV00SAF-1" value="" style="shape=module;jettyWidth=8;jettyHeight=4;" parent="913VA-e47dgmbzV00SAF-0" vertex="1">
          <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
            <mxPoint x="-27" y="7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="913VA-e47dgmbzV00SAF-4" value="Поведение пользователя" style="swimlane;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="10" y="920" width="560" height="430" as="geometry" />
        </mxCell>
        <mxCell id="OZho7mV1Ze3KkDtRldih-55" value="&lt;p style=&quot;line-height: 1.2&quot;&gt;1. Выбирает тип подписки на фронте&lt;br&gt;2. Запрос уходит на subscription api (POST)&lt;br&gt;3. Формируем подписку в Stripe&lt;br&gt;4. Внутри sub api , мы создаем запись в бд о намерении подписки (статус pending/active/cancelled)&lt;br&gt;5. Формируем url для оплаты и&amp;nbsp; редиректим user-а&lt;br&gt;6. Success url / Cancell url&lt;br&gt;- После оплаты пользователя редиректит на success callback url.&lt;br&gt;- В случае отмены пользователем нас редиректит на cancelled callback url&lt;br&gt;- или по прошествию 24 часов invoice автоматически&amp;nbsp; переходит в cancelled&lt;br&gt;7.Внутри callback url мы отправляем таску в кьюху об успешной подписке&lt;br&gt;8)Воркер забирает таску:&lt;br&gt;-изменяет статус записи о намерении на success или cancelled&lt;br&gt;-создает запись в БД об активной подписке(ПОДУМАТЬ)&lt;br&gt;- отправляет сообщение в центр уведомлений&lt;br&gt;-изменяет стутас пользователя в Auth(пишем что есть активная подписка)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Шедулер(контроль оплаты подписок) поллит БД на тему pending подписок и проверяет не были ли они оплачены. Если оплата прошла(лезем в страйп проверять) но по какой-то причине мы ее не активировали, то мы отправляет таску в кьюху для того чтобы воркер сделал своё дело.&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="913VA-e47dgmbzV00SAF-4" vertex="1">
          <mxGeometry y="30" width="560" height="310" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
